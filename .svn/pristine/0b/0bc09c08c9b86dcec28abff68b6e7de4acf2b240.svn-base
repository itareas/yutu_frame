package com.yutu.service.impl;

import com.yutu.entity.MsgPack;
import com.yutu.mapper.mysql.IMySqlMapper;
import com.yutu.mapper.oracle.IOracleMapper;
import com.yutu.mapper.sqlserver.ISqlServerMapper;
import com.yutu.service.IHomeService;
import org.springframework.stereotype.Service;

import javax.annotation.Resource;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * @ClassName: HomeServiceImpl
 * @Author: zhaobc
 * @Date: 2019/6/26 17:43
 * @Description:
 **/
@Service
public class HomeServiceImpl implements IHomeService {
    @Resource
    private ISqlServerMapper sqlServerMapper;
    @Resource
    private IOracleMapper oracleMapper;
    @Resource
    private IMySqlMapper mySqlMapper;


    @Override
    public MsgPack getDataSource() {
        //声明返回数据
        MsgPack msgPack = new MsgPack();

        //获得不同数据源信息
        List<Map<String, Object>> listSqlServer = sqlServerMapper.getSqlServerTest("R");
        List<Map<String, Object>> listOracle = oracleMapper.getOracleTest("1");
        List<Map<String, Object>> listMySql = mySqlMapper.getMySqlTest("yt");

        //判断是否成功
        if (listSqlServer.size() > 0 && listOracle.size() > 0 && listMySql.size() > 0) {
            msgPack.setStatus(1);
            msgPack.setMsg("获取数据成功");
        } else {
            msgPack.setStatus(0);
            msgPack.setMsg("获取数据失败");
        }

        //集成数据
        Map<String, Object> mapData = new HashMap<String, Object>();
        mapData.put("SqlServer", listSqlServer);
        mapData.put("Oracle", listOracle);
        mapData.put("MySql", listMySql);
        msgPack.setData(mapData);

        return msgPack;
    }
}
